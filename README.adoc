= OpenShift - Advanced Cluster Management
Álvaro López Medina <alopezme@redhat.com>
v1.0, 2023-09
// Metadata
:description: This repository explores the typical installation scenarios and relevant considerations
:keywords: openshift, red hat, installation, management, ACM
// Create TOC wherever needed
:toc: macro
:sectanchors:
:sectnumlevels: 2
:sectnums: 
:source-highlighter: pygments
:imagesdir: docs/images
// Start: Enable admonition icons
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
// Icons for GitHub
:yes: :heavy_check_mark:
:no: :x:
endif::[]
ifndef::env-github[]
:icons: font
// Icons not for GitHub
:yes: icon:check[]
:no: icon:times[]
endif::[]
// End: Enable admonition icons


This repository explores the typical installation scenarios and relevant considerations of OpenShift Advanced Cluster Management.

// Create the Table of contents here
toc::[]

== Introduction

Red Hat Advanced Cluster Management (ACM) allows organizations to rapidly deploy OpenShift to Cloud and On-Premise locations as well as manage the Kubernetes fleet of clusters.


.Advanced Cluster Management Architecture
image::acm-architecture.png[ACM architecture, link=https://raw.githubusercontent.com/redhataccess/documentation-svg-assets/master/for-web/RHACM/186_RHACM/186_RHACM_misc._1221_multicluster-arc.png]


This is the https://github.com/redhataccess/documentation-svg-assets/blob/master/for-web/RHACM/186_RHACM/186_RHACM_misc._1221_multicluster-arc.png[source] of the diagram.


== Installing: Automated

Are you in a hurry? Do you need a one-click script? Okay, I understand! Execute the following command:

[source, bash]
----
auto-install.sh
----


== Installing: Manual

The process of installing is not that complex, but it can be divided in two steps. First, creating the namespace for ACM and installing the operator. Second, create the `MultiClusterHub` to actually install ACM components.

=== Step 1: The ACM operator

[source, bash]
----
oc process -f openshift/00-operator.yaml | oc apply -f -
----


=== Step 2: The ACM Hub cluster

[source, bash]
----
oc process -f openshift/10-multi-cluster-hub.yaml | oc apply -f -
----



== Cluster lifecycle with multicluster engine operator


The multicluster engine for Kubernetes operator is the cluster lifecycle operator that provides cluster management capabilities for Red Hat OpenShift Container Platform and Red Hat Advanced Cluster Management hub clusters.


=== Create a new managed cluster

Please, review the content of the `openshift/20-managed-cluster.yaml` and add in the template all the values for your cluster. Then, apply the secret as in the following example:

NOTE: Before trying to update all the values, I recommend you to check the official documentation, which will save you time: https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.8/html-single/clusters/index#vsphere_cred

[source, bash]
----
oc process -f openshift/20-managed-cluster.yaml | oc apply -f -
----



== Observability


You can use Red Hat Advanced Cluster Management for Kubernetes to gain insight and optimize your managed clusters.

NOTE: Due to the requirement for persistent storage, the observability service is not enabled by default. You must configure an object store to create a storage solution. 


[source, bash]
----
oc process -f openshift/11-multi-cluster-observability.yaml \
    --param-file ./aws-env-vars --ignore-unknown-parameters=true \
    -p DOCKER_CONFIG_JSON="$(oc extract secret/pull-secret -n openshift-config --to=-)" | oc apply -f -
----


.ACM Observability Grafana
image::acm-observability-grafana.png[ACM Observability Grafana]
